{"ast":null,"code":"'use strict';\n\nvar captureLastRun = require('last-run').capture;\nvar releaseLastRun = require('last-run').release;\nvar metadata = require('./metadata');\nvar uid = 0;\nfunction Storage(fn) {\n  var meta = metadata.get(fn);\n  this.fn = meta.orig || fn;\n  this.uid = uid++;\n  this.name = meta.name;\n  this.branch = meta.branch || false;\n  this.captureTime = Date.now();\n  this.startHr = [];\n}\nStorage.prototype.capture = function () {\n  captureLastRun(this.fn, this.captureTime);\n};\nStorage.prototype.release = function () {\n  releaseLastRun(this.fn);\n};\nfunction createExtensions(ee) {\n  return {\n    create: function (fn) {\n      return new Storage(fn);\n    },\n    before: function (storage) {\n      storage.startHr = process.hrtime();\n      ee.emit('start', {\n        uid: storage.uid,\n        name: storage.name,\n        branch: storage.branch,\n        time: Date.now()\n      });\n    },\n    after: function (result, storage) {\n      if (result && result.state === 'error') {\n        return this.error(result.value, storage);\n      }\n      storage.capture();\n      ee.emit('stop', {\n        uid: storage.uid,\n        name: storage.name,\n        branch: storage.branch,\n        duration: process.hrtime(storage.startHr),\n        time: Date.now()\n      });\n    },\n    error: function (error, storage) {\n      if (Array.isArray(error)) {\n        error = error[0];\n      }\n      storage.release();\n      ee.emit('error', {\n        uid: storage.uid,\n        name: storage.name,\n        branch: storage.branch,\n        error: error,\n        duration: process.hrtime(storage.startHr),\n        time: Date.now()\n      });\n    }\n  };\n}\nmodule.exports = createExtensions;","map":{"version":3,"names":["captureLastRun","require","capture","releaseLastRun","release","metadata","uid","Storage","fn","meta","get","orig","name","branch","captureTime","Date","now","startHr","prototype","createExtensions","ee","create","before","storage","process","hrtime","emit","time","after","result","state","error","value","duration","Array","isArray","module","exports"],"sources":["/home/krishnansh/Documents/WebDev/PS/notus-react-main/node_modules/undertaker/lib/helpers/createExtensions.js"],"sourcesContent":["'use strict';\n\nvar captureLastRun = require('last-run').capture;\nvar releaseLastRun = require('last-run').release;\n\nvar metadata = require('./metadata');\n\nvar uid = 0;\n\nfunction Storage(fn) {\n  var meta = metadata.get(fn);\n\n  this.fn = meta.orig || fn;\n  this.uid = uid++;\n  this.name = meta.name;\n  this.branch = meta.branch || false;\n  this.captureTime = Date.now();\n  this.startHr = [];\n}\n\nStorage.prototype.capture = function() {\n  captureLastRun(this.fn, this.captureTime);\n};\n\nStorage.prototype.release = function() {\n  releaseLastRun(this.fn);\n};\n\nfunction createExtensions(ee) {\n  return {\n    create: function(fn) {\n      return new Storage(fn);\n    },\n    before: function(storage) {\n      storage.startHr = process.hrtime();\n      ee.emit('start', {\n        uid: storage.uid,\n        name: storage.name,\n        branch: storage.branch,\n        time: Date.now(),\n      });\n    },\n    after: function(result, storage) {\n      if (result && result.state === 'error') {\n        return this.error(result.value, storage);\n      }\n      storage.capture();\n      ee.emit('stop', {\n        uid: storage.uid,\n        name: storage.name,\n        branch: storage.branch,\n        duration: process.hrtime(storage.startHr),\n        time: Date.now(),\n      });\n    },\n    error: function(error, storage) {\n      if (Array.isArray(error)) {\n        error = error[0];\n      }\n      storage.release();\n      ee.emit('error', {\n        uid: storage.uid,\n        name: storage.name,\n        branch: storage.branch,\n        error: error,\n        duration: process.hrtime(storage.startHr),\n        time: Date.now(),\n      });\n    },\n  };\n}\n\nmodule.exports = createExtensions;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}